<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.co.kmac.system.mapper.VoctypeMstMapper">

    <!-- VOC유형마스터정보 목록 조회 -->
    <select id="getVoctypeMstList" resultType="kr.co.kmac.system.dto.VoctypeMstDto$Info">
        SELECT  voctype_mst_seq     AS "voctypeMstSeq",
                voctype_grp_cd      AS "voctypeGrpCd",
                voctype_grp_nm      AS "voctypeGrpNm",
                industry_cd         AS "industryCd",
                voctype_desc        AS "voctypeDesc",
                use_yn              AS "useYn",
                reg_user_no         AS "regUserNo",
                fn_getUserNm(reg_user_no) AS "regUserNm",
                date_format(reg_dt, '%Y-%m-%d %H:%i:%s') AS "regDt",
                mod_user_no          AS "modUserNo",
                fn_getUserNm(mod_user_no) AS "modUserNm",
                date_format(mod_dt, '%Y-%m-%d %H:%i:%s') AS "modDt"
        FROM tb_sys_voctype_mst
        <where>
            <if test="@org.apache.commons.lang3.ObjectUtils@isNotEmpty(industryCd)">AND industry_cd = #{industryCd} </if>
            <if test="@org.apache.commons.lang3.ObjectUtils@isNotEmpty(useYn)">AND use_yn = #{useYn} </if>
            <if test="@org.apache.commons.lang3.ObjectUtils@isNotEmpty(voctypeMstNm)">AND voctype_grp_nm LIKE CONCAT('%',#{voctypeNm},'%') </if>
        </where>
        ORDER BY voctype_mst_seq DESC
        <if test="offset &gt; -1">
            LIMIT #{offset}, #{length}
        </if>
    </select>
    <select id="getVoctypeMstListCount" resultType="long">
        SELECT COUNT(1)
        FROM tb_sys_voctype_mst
        <where>
            <if test="@org.apache.commons.lang3.ObjectUtils@isNotEmpty(voctypeMstCd)">AND voctype_grp_cd = #{voctypeMstCd} </if>
            <if test="@org.apache.commons.lang3.ObjectUtils@isNotEmpty(useYn)">AND use_yn = #{useYn} </if>
            <if test="@org.apache.commons.lang3.ObjectUtils@isNotEmpty(voctypeMstNm)">AND voctype_grp_nm LIKE CONCAT('%',#{voctypeMstNm},'%') </if>
        </where>
    </select>

	<!-- VOC유형마스터정보 상세 조회 -->
    <select id="getVoctypeMst" resultType="kr.co.kmac.system.dto.VoctypeMstDto$Info">
        SELECT voctype_mst_seq     AS "voctypeMstSeq",
               voctype_grp_cd      AS "voctypeGrpCd",
               voctype_grp_nm      AS "voctypeGrpNm",
               industry_cd         AS "industryCd",
               voctype_desc        AS "voctypeDesc",
               use_yn              AS "useYn",
               reg_user_no         AS "regUserNo",
               fn_getUserNm(reg_user_no) AS "regUserNm",
               date_format(reg_dt, '%Y-%m-%d %H:%i:%s') AS "regDt",
               mod_user_no          AS "modUserNo",
               fn_getUserNm(mod_user_no) AS "modUserNm",
               date_format(mod_dt, '%Y-%m-%d %H:%i:%s') AS "modDt"
          FROM tb_sys_voctype_mst A
         WHERE voctype_mst_seq=#{voctypeMstSeq}
    </select>

	<!-- VOC유형마스터정보 등록 -->
    <insert id="insertVoctypeMst">
        INSERT INTO tb_sys_voctype_mst
        (
            voctype_grp_cd,
            voctype_grp_nm,
            industry_cd,
            voctype_desc,
            use_yn,
            reg_user_no,
            mod_user_no
        )
        VALUES
        (
            #{voctypeGrpCd},
            #{voctypeGrpNm},
            #{industryCd},
            #{voctypeDesc},
            'Y',
            #{regUserNo},
            #{modUserNo}
        )
        <selectKey resultType="int" keyProperty="returnKey" order="AFTER">
            SELECT LAST_INSERT_ID()
        </selectKey>
    </insert>

	<!-- VOC유형마스터정보 수정 -->
    <update id="updateVoctypeMst">
        UPDATE tb_sys_voctype_mst SET
               voctype_grp_cd      = #{voctypeGrpCd},
               voctype_grp_nm      = #{voctypeGrpNm},
               industry_cd         = #{industryCd},
               voctype_desc        = #{voctypeDesc},
               mod_user_no         = #{modUserNo}
        WHERE voctype_mst_seq=#{voctypeMstSeq}
	</update>

	<!-- VOC유형마스터정보 삭제 -->
    <update id="deleteVoctypeMst">
        DELETE FROM tb_sys_voctype_mst
         WHERE voctype_mst_seq=#{voctypeMstSeq}
    </update>
</mapper>
